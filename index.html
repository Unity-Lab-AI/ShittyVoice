<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unity Voice Chat</title>
    <script>
        (() => {
            const href = window.location.href;
            const pathname = window.location.pathname || '';
            const lastSegment = pathname.substring(pathname.lastIndexOf('/') + 1);

            const directoryUrl = href.endsWith('/')
                ? href
                : lastSegment && lastSegment.includes('.')
                  ? href.substring(0, href.lastIndexOf('/') + 1)
                  : `${href}/`;

            window.__UNITY_VOICE_DIRECTORY_URL__ = directoryUrl;

            const resolveAsset = (relativePath) => {
                try {
                    return new URL(relativePath, directoryUrl).toString();
                } catch (error) {
                    console.error('Failed to resolve asset path:', error);
                    return relativePath;
                }
            };

            const styleLink = document.createElement('link');
            styleLink.rel = 'stylesheet';
            styleLink.href = resolveAsset('style.css');
            document.head.appendChild(styleLink);

            const script = document.createElement('script');
            script.defer = true;
            script.src = resolveAsset('app.js');
            document.head.appendChild(script);
        })();
    </script>
</head>
<body>
    <div id="background" aria-hidden="true"></div>
    <main class="layout" aria-live="polite">
        <section class="voice-stage" role="group" aria-label="Voice activity monitors">
            <article class="voice-circle ai" data-role="ai" aria-label="Unity is idle">
                <div class="pulse-ring"></div>
                <span class="sr-only">Unity</span>
            </article>
            <article class="voice-circle user" data-role="user" aria-label="Microphone is muted">
                <div class="pulse-ring"></div>
                <span class="sr-only">You</span>
            </article>
        </section>
    </main>
    <button id="mute-indicator" class="mute-indicator" data-state="muted" type="button">
        <span class="indicator-text">Tap or click anywhere to unmute</span>
    </button>
</body>
</html>
